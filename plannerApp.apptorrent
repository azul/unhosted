var appTorrent =
  { author: 'Kailash Nadh, http://kailashnadh.name   (August 2011)'
  , title: 'Simple Planner'
  , description: 'A localStorage based personal planner prototype. Made for 10K Apart'
  , packager: 'Michiel de Jong'
  , js: 'var Planner={'
      +'DAYS:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],LABELS:["todo","personal","work","important","misc"],Date:new Date,UI:null,EVENTS:{},diary_open:false'
      +',init:function(){this.EVENTS=localStorage["events"];if(!this.EVENTS){this.EVENTS={};if(!localStorage.setup){var a={"1-0":"New Year","8-2":"Commonwealth Day","17-2":"St. Patrick\'s Day","1-3":"April fools","22-3":"Earth Day","1-4":"May Day","5-4":"Cinco de Mayo","4-6":"Independence Day (US)","3-7":"Friendship Day","10-7":"Rollercoaster Day","17-8":"International Day of Peace","16-9":"World Food Day","31-9":"Halloween","4-10":"Diwali","17-10":"World Peace Day","22-10":"Thanksgiving","25-11":"Christmas"};for(var b=this.Date.getFullYear();b<=this.Date.getFullYear()+1;b++){for(var c in a){this.createEvent(c+"-"+b,"00","00",a[c],"misc")}}for(var d=0;d<7;d++){this.createEvent(Math.floor(Math.random()*28)+"-"+this.Date.getMonth()+"-"+this.Date.getFullYear(),Math.floor(Math.random()*23).pad(2),"00","This is a dummy event. The number "+d+" is cool!",this.LABELS[Math.floor(Math.random()*(this.LABELS.length-1))])}localStorage.setup=1}}else{try{this.EVENTS=JSON.parse(this.EVENTS)}catch(e){localStorage.clear();this.EVENTS={}}}this.phone=navigator.userAgent.match(/phone/i)||navigator.userAgent.match(/android/i);this.setDate();this.initUI();var f=document.location.href.match(/([0-9]{1,2})\-([0-9]{4})/i);if(f&&f[1]>=1&&f[1]<=12&&f[2]>=1900&&f[2]<=2050){this.specificMonth(f[1],f[2])}else{this.today()}Planner.renderDiary($(".day"+this.date).data("id"));this.UI.resize();Planner.UI.diary_wrap.show();var g=Planner.UI.diary_wrap.offset().left-Planner.UI.calendar_wrap.innerWidth();Planner.UI.diary_wrap.hide();if(!this.phone&&g>-35&&(new Date).getMonth()==this.month){Planner.showDiary()}}'
//      +',initUI:function(){this.UI={themes:["dark","light"],calendar:$("#calendar"),dialog:$("#dialog"),add:$("#add"),calendar_wrap:$("#calendar-wrap"),diary_wrap:$("#diary-wrap"),event_label:$("#event-label"),event_hour:$("#event-hour"),event_minute:$("#event-minute"),event_description:$("#event-description"),event_delete:$("#event-delete"),event_tweet:$("#event-tweet"),diary:$("#diary")};var a="";for(d=0;d<24;d++){a=d.pad(2);this.UI.event_hour.append($(\'<option value="\'+a+\'">\').html(a))}for(d=0;d<60;d+=15){a=d.pad(2);a=a.substr(a.length-2);this.UI.event_minute.append($(\'<option value="\'+a+\'">\').html(a))}var b=$(\'<div class="labels">\'),c="";for(var d in this.LABELS){c=this.LABELS[d];b.append($(\'<label class="\'+c+\' label" for="label-\'+c+\'">\'+c+\' <input type="radio" name="event-label" value="\'+c+\'" id="label-\'+c+\'" class="\'+c+\'"></label>\'))}this.UI.event_label.append(b);var e="";for(var d=0;d<7;d++){e+="<td>"+this.DAYS[d]+"</td>"}$("thead").append($("<tr>").html(e));$("#event-close").click(function(){Planner.closeAddPrompt()});$("#dialog-close").click(function(){Planner.closeDialog();return false});$(document).keyup(function(a){if(a.altKey)return;if(a.keyCode==27){Planner.closeAddPrompt()}else if(a.keyCode==37){Planner.previousMonth()}else if(a.keyCode==39){Planner.nextMonth()}else if(a.keyCode==38||a.keyCode==40){Planner.today()}});this.UI.add.submit(function(){Planner.createEvent(Planner.new_id,Planner.UI.event_hour.val(),Planner.UI.event_minute.val(),Planner.UI.event_description.val().replace(/<\/?(?!\!)[^>]*>/gi,""),Planner.UI.event_label.find(\'input[name="event-label"]:checked\').val(),Planner.event_i);Planner.closeAddPrompt();Planner.renderEvents();if(Planner.diary_open){Planner.renderDiary(Planner.new_id)}return false});this.UI.event_delete.click(function(){var a=$(this).data("id");Planner.deleteEvent(a,$(this).data("i"));Planner.closeDialog();Planner.renderCalendar();Planner.renderDiary(a);return false});this.UI.event_tweet.click(function(){var a=$(this).data("id");var b=Planner.EVENTS[a][$(this).data("i")];window.open("http://twitter.com/home?status="+escape(b.description+" @ "+b.hour+":"+b.minute+", "+Planner.dateStringID(a)));return false});$("#btn-previous").click(function(){Planner.previousMonth();return false});$("#btn-next").click(function(){Planner.nextMonth();return false});$("#btn-today").click(function(){Planner.today();return false});$("#btn-theme").click(function(){var a=(parseInt($(this).data("theme"))+1)%2;localStorage.theme=a;Planner.theme(a);$(this).data("theme",a).html(Planner.UI.themes[(a+1)%2]);return false});if(localStorage.theme){Planner.theme(localStorage.theme);$("#btn-theme").data("theme",localStorage.theme).html(this.UI.themes[(parseInt(localStorage.theme)+1)%2])}else{$("#btn-theme").data("theme",0).html(this.UI.themes[1])}$("#ical-data").click(function(){$(this).select()});$("#btn-ical").click(function(){$("#ical-data").text(Planner.exportIcal());Planner.dialog($("#ical"));return false});$("#diary-close").click(function(){this.diary_open=true;Planner.UI.diary_wrap.hide();return false});this.updateTime();window.setInterval(function(){Planner.updateTime()},1e3);this.UI.resize=function(){var a=$(window).height(),b=$(window).width(),c=0;var d=Math.min(b,a);d=Math.max(d,400);c=d/1.2;Planner.UI.calendar.width(c);Planner.UI.calendar.height(c);$("td").css("width",c/7);Planner.UI.diary_wrap.height("auto");Planner.UI.calendar_wrap.height("auto");var e=Math.max(Planner.UI.calendar_wrap.outerHeight(),Planner.UI.diary_wrap.outerHeight(),a);Planner.UI.calendar_wrap.height(e);Planner.UI.diary_wrap.height(e);Planner.UI.diary_wrap.width("auto");if(Planner.UI.calendar_wrap.outerWidth()+Planner.UI.diary_wrap.outerWidth()>b){$("body").addClass("compact")}else{$("body").removeClass("compact")}};$(window).resize(function(){Planner.UI.resize()})}'
      +',renderCalendar:function(){document.location.href="#"+(this.month+1+"-"+this.year);var a=0,b=null,c=$(\'<tbody class="month\'+this.month+\'">\');if(this.weekstart>0){b=$("<tr>").addClass("w0");for(var d=0;d<this.weekstart;d++){b.append($(\'<td class="day">\'))}c.append(b);a++}for(var e=1;e<=this.num_days;e++){var f=(this.weekstart+e-1)%7;if(f==0){b=$("<tr>");c.append(b);a++}var g=e+"-"+this.month+"-"+this.year;b.append($(\'<td valign="top" class="day">\').addClass("day"+e).addClass("day"+g).append($(\'<div class="\'+g+\'">\').append($(\'<span class="d">\').html(e)).append($(\'<a href="#" title="add an event" class="round add">+</a>\').data("id",g).click(function(){Planner.addPrompt($(this).data("id"));return false}))).data("id",g).click(function(){Planner.renderDiary($(this).data("id"));Planner.showDiary()}))}$("#calendar-title").html(this.MONTHS[this.month]+" "+this.year);$("tbody").replaceWith(c);$(".month"+(new Date).getMonth()+" .day"+this.date).addClass("today");$(".month"+this.month+" .day"+this.date).addClass("marked");$("td.day").hover(function(){$(this).find(".add").stop().animate({opacity:1},300)},function(){$(this).find(".add").stop().animate({opacity:0},200)});this.renderEvents()}'
      +',renderEvents:function(){$(".d .events").remove();for(var a in this.EVENTS){var b=$("<ul>");$.each(this.EVENTS[a],function(){b.append($(\'<li class="label \'+this.label+\'">\').append($(\'<span class="time">\'+this.hour+":"+this.minute+"</span>")).append($(\'<span class="desc">\'+this.description+"</span>")))});$("."+a).append(b)}var c=this.stats();$("#stats").html(c.future+" upcoming events and "+c.past+" past events")}'
      +',showDiary:function(){this.diary_open=true;this.UI.diary_wrap.show()}'
      +',renderDiary:function(a){$("#diary li").remove();$("#diary-title").html(this.dateStringID(a));$(".day").removeClass("selected");$(".day"+a).addClass("selected");for(var b=0;b<24;b++){var c="0"+b;c=c.substr(c.length-2);$("#diary").append($("<li>").append($(\'<a href="#" class="time">\'+c+":00</a>").data({hour:c,minute:"00"}).data("hour",c).click(function(){Planner.addPrompt(a,null,$(this).data("hour"),"00");return false})).append(\'<div class="clear"> </div>\').addClass("hour"+c))}if(!this.EVENTS[a])return;var d={};$.each(this.EVENTS[a],function(b){$("#diary .hour"+this.hour).after($("<li>").append($(\'<a href="#" class="time label \'+this.label+\'">\'+this.hour+":"+this.minute+"</a>").click(function(){Planner.addPrompt(a,b);return false})).append($(\'<span class="desc">\'+this.description+" </span>")).append(\'<div class="clear"> </div>\'));if(parseInt(this.minute)===0){d[this.hour]=true}});for(var e in d){$("#diary .hour"+e).remove()}}'
      +',dialog:function(a){this.UI.dialog.find(".target").hide();a.show();this.UI.dialog.width(this.UI.calendar.width()/2);this.UI.dialog.css("top",($(window).height()-this.UI.dialog.height())/2).css("left",(this.UI.calendar.width()-this.UI.dialog.width())/2);this.UI.dialog.show()}'
      +',closeDialog:function(){this.UI.dialog.hide()}'
      +',addPrompt:function(a,b,c,d){this.new_id=a;this.event_i=null;this.UI.event_description.val("");this.UI.event_label.find("input:first").attr("checked","checked");this.UI.event_tweet.hide();this.UI.event_delete.hide();if(a&&b!=null&&this.EVENTS[a][b]){this.UI.event_description.val(this.EVENTS[a][b].description);this.UI.event_hour.val(this.EVENTS[a][b].hour);this.UI.event_minute.val(this.EVENTS[a][b].minute);this.UI.event_label.find("."+this.EVENTS[a][b].label+" input").attr("checked","checked");this.event_i=b;this.UI.event_delete.data({id:a,i:b}).show();this.UI.event_tweet.data({id:a,i:b}).show()}else if(c&&d){this.UI.event_hour.val(c);this.UI.event_minute.val(d)}$("#event-date").html(this.dateStringID(a));this.dialog(this.UI.add);this.UI.event_description.focus();return false}'
      +',closeAddPrompt:function(){this.closeDialog()}'
      +',deleteEvent:function(a,b){this.EVENTS[a].splice(b,1);localStorage["events"]=JSON.stringify(this.EVENTS)}'
      +',createEvent:function(a,b,c,d,e,f){if(!this.EVENTS[a]){this.EVENTS[a]=[]}var g={description:d,hour:b,minute:c,label:e};if(!f||f==null){this.EVENTS[a].push(g)}else{this.EVENTS[a][f]=g}this.EVENTS[a].sort(function(a,b){return parseInt(a.hour+""+a.minute)-parseInt(b.hour+""+b.minute)});localStorage["events"]=JSON.stringify(this.EVENTS)}'

      +',exportIcal:function(){var a="";a="BEGIN:VCALENDAR\\nMETHOD:PUBLISH\\nVERSION:2.0\\nCALSCALE:GREGORIAN\\n\\n";for(var b in this.EVENTS){var c=Planner.dateFromID(b);$.each(this.EVENTS[b],function(){a+="BEGIN:VEVENT\\n";a+="DTSTART:"+[c.getFullYear(),c.getMonth().pad(2),c.getDate().pad(2),"T",this.hour,this.minute,"00"].join("")+"\\n";a+="SUMMARY:"+this.description+"\\n";a+="END:VEVENT\\n\\n"})}a+="\\nEND:VCALENDAR";return a}'

      +',today:function(){this.Date=new Date;this.setDate();this.renderCalendar()}'
      +',nextMonth:function(){this.Date.setMonth(this.month+1);this.setDate();this.renderCalendar()}'
      +',previousMonth:function(){this.Date.setMonth(this.Month-1<0?11:this.month-1);this.setDate();this.renderCalendar()}'
      +',specificMonth:function(a,b){this.Date.setMonth(a-1);this.Date.setYear(b);this.setDate();this.renderCalendar()}'
      +',weekDay:function(a){return(a-1).mod(7)}'
      +',setDate:function(){this.day=this.Date.getDay();this.weekstart=new Date(this.Date.getTime());this.weekstart.setDate(1);this.weekstart=this.weekDay(this.weekstart.getDay());this.date=this.Date.getDate();this.month=this.Date.getMonth();this.year=this.Date.getFullYear();this.num_days=32-(new Date(this.year,this.month,32)).getDate()}'
      +',dateStringID:function(a){var b=this.dateFromID(a),c=b.getDate();c+=c>10&&c<20?"th":{1:"st",2:"nd",3:"rd"}[c%10]||"th";return this.DAYS[this.weekDay(b.getDay())]+", "+c+" "+this.MONTHS[b.getMonth()]+", "+b.getFullYear()}'
      +',dateFromID:function(a){a=a.split("-");return new Date(a[2],a[1],a[0])}'
      +',updateTime:function(){var a=new Date;$("#time").html(a.getHours().pad(2)+":"+a.getMinutes().pad(2))}'
      +',stats:function(){var a={past:0,future:0};var b=new Date;for(var c in this.EVENTS){var d=Planner.dateFromID(c);if(d.getTime()>b.getTime()){a.future++}else{a.past++}}return a}'
      +',theme:function(a){$("body").removeClass(Planner.UI.themes.join(" ")).addClass(Planner.UI.themes[a])}'
      +'};Number.prototype.mod=function(a){return(this%a+a)%a};Number.prototype.pad=function(a){var b="0"+this;return b.substr(b.length-a)};$(document).ready(function(){Planner.init()})'
  , css:
    [ 'html {height: 100%;}'
    , 'body {background: #eee;font-family: Helvetica Neue, Helvetica, Arial;font-size: 1em;color: #333;height: 100%;margin: 0;padding: 0;}'
    , '.box {background: #fff;box-shadow: 0 0 30px #ddd;}'
    , '#calendar-wrap {padding-right: 35px;float: left;z-index: 1;overflow: hidden;}'
    , '#calendar {position: relative;margin: 15px;}'
    , '#stats {color: #aaa;margin-top: 15px;}'
    , '#calendar-title {text-transform: lowercase;margin-bottom: 10px;float: left;width: 40%;}'
    , '#time {color: #aaa;}'
    , 'table {width: 100%;height: 80%;margin-top: 30px;border-spacing: 0;}'
    , 'thead td {font-size: 18px;text-align: center;height: 40px;}'
    , 'tbody td {border-width: 0 1px 1px 0;border-style: solid;border-color: #ddd;padding: 10px;overflow: hidden;}'
    , 'thead td {border-bottom: 1px solid #ddd;}'
    , 'tbody tr td:nth-child(1) {border-left: 1px solid #ddd;}'
    , '.day {background: #fff url(\'w.png\') repeat-x bottom left;overflow: hidden;cursor: pointer;}'
    , '.day div {position: relative;}'
    , '.day:hover {background: #fff;}'
    , '.day .d {position: absolute;top: 0;right: 0;}'
    , '.selected .d {text-decoration: underline;}'
    , '.today  {background: #feffb9;}'
    , '.marked .d {font-weight: bold;}'
    , '.day .add {position: absolute;top: 0px;left: 0px;line-height: 16px;width: 15px;height: 15px;opacity: 0;}'
    , '.day ul {position: absolute;font-size: 11px;top: 25px;width: 100%;}'
    , '.day li {padding: 2px;width: 100%;margin-bottom: 1px;overflow: hidden;height: 14px;}'
    , '.day ul .time {margin-right: 5px;}'
    , '#diary-wrap {border-left: 1px solid #ddd;float: left;width: 30%;display: none;}'
    , '#diary-title {float: left;}'
    , '#diary-close {float: left;margin: 1px 15px 10px 0;}'
    , '#diary-wrap .content {margin: 15px;}'
    , '.compact #diary-wrap {position: absolute;top: 0;right: 0;z-index: 5;margin-left: 40px;}'
    , '.compact #calendar-title {float: none;}'
    , '.compact #controls {float: none;}'
    , '#diary {font-size: 12px;margin: 15px;}'
    , '#diary li {margin-bottom: 3px;}'
    , '#diary .time {background: #bbb;color: #fff;padding: 2px;display: block;width: 100px;float: left;margin-right: 15px;border-radius: 5px;}'
    , '#diary .time:hover {background: #000;}'
    , '#diary .desc {display: inline-block;padding: 0 0 3px 0;overflow: hidden;border-bottom: 1px solid #ddd;}'
    , '#dialog {background: #fff url(\'w.png\') repeat-x bottom left;display: none;padding: 15px 25px;position: absolute;z-index: 10;box-shadow: 0 0 30px #aaa;border-radius: 10px;}'
    , '#dialog-close {float: right;margin: -5px -15px 10px 10px;}'
    , '#dialog .target {display: none;}'
    , '#add #event-description {width: 90%;}'
    , '#add label {display: block;font-weight: bold;margin-bottom: 5px;}'
    , '#add p.time {margin-bottom: 10px;}'
    , '#add .label {font-size: 11px;font-weight: normal;display: inline-block;margin-right: 10px;}'
    , '#add #event-label input {padding: 0;}'
    , '#add .buttons {margin-top: 30px;}'
    , '#event-tweet,#event-delete {float: right;display: none;margin-left: 5px;}'
    , '#event-tweet {background-image: url(\'t.png\');background-repeat: no-repeat;background-position: 3px 9px;padding-left: 22px;}'
    , '#ical-data {margin-top: 15px;width: 100%;font-size: 11px;height: 250px;}'
    , '#controls {float: right;margin-top: 8px;}'
    , '#controls li {display: inline-block;margin-left: 5px;}'
    , '#controls .sep {margin-right: 35px;}'
    , '.button, #controls a {background: #000;font-size: 12px;color: #fff;display: inline-block;padding: 5px 12px;border-radius: 5px;}'
    , '.button {border: 0;margin: 0;font-weight: bold;font-size: 15px;cursor: pointer;}'
    , '#controls a:hover {background: #3366cc;}'
    , '#credit {background: #eee;border-radius: 3px;padding: 3px 5px;margin-top: 15px;display: inline-block;}'
    , '.label {padding: 3px;color: #fff !important;border-radius: 3px;}'
    , '.important {background: #ff0000 !important;}'
    , '.todo {background: #3366cc !important;}'
    , '.personal {background: #35A200 !important;}'
    , '.work {background: #D89700 !important;}'
    , '.misc {background: #48BFF2 !important;}'
    , '.clear {clear: both;}'
    , '.info {font-size: 12px;color: #666;}'
    , '.round {display: block;width: 20px;height: 20px;border: 3px solid #000;border-radius: 20px;font-weight: bold;text-align: center;overflow: hidden;}'
    , '.round:hover {border-color: #3366cc;color: #3366cc;}'
    , 'h1, h2, h3, h4 {margin: 0 0 25px 0;font-weight: normal;}'
    , 'a {color: #000;text-decoration: none;}'
    , 'input, select {padding: 10px;}'
    , 'ul {list-style-type: none;margin: 0;padding: 0;}'
    , '.dark {background: #333;color: #ccc;}'
    , '.dark #time {color: #ccc;}'
    , '.dark #stats {color: #666;}'
    , '.dark .box {background: #212121;box-shadow: 0 0 30px #111;}'
    , '.dark #dialog {background: #212121;border: 1px solid #444;box-shadow: 0 0 30px #000;}'
    , '.dark #diary-wrap {border: 0;border-right: 1px solid #1e1e1e;}'
    , '.dark #controls a {background: #ff4800;}'
    , '.dark #controls a:hover {background: #cc0000;}'
    , '.dark .round {border-color: #ff4800;color: #ff4800;}'
    , '.dark .round:hover {border-color: #aaa;color: #aaa;}'
    , '.dark .day {background: #191919;}'
    , '.dark tbody td,.dark thead td,.dark tbody tr td:nth-child(1) {border-color: #2e2e2e;}'
    , '.dark  #diary .time {background: #444;color: #ccc;}'
    , '.dark #diary .desc {border-color: #444;}'
    , '.dark #credit {background: #111;}'
    , '.dark #credit a {color: #ddd;}'
    , '.dark .today  {background: #333;}'
    , '.dark .info {color: #999;}'
    , '.dark #ical-data {background: #222;color: #aaa;border: 1px solid #333;}'
    , '.dark .button {background: #666;}'
    ]
  , html: '<div id="calendar-wrap" class="box"><div id="calendar"><h1 id="calendar-title"> </h1><ul id="controls"><li><a href="#" id="btn-theme">light</a></li><li class="sep"><a href="#" id="btn-ical">iCal</a></li><li><a href="#" id="btn-previous">&laquo;</a></li><li><a href="#" id="btn-today">today</a></li><li><a href="#" id="btn-next">&raquo;</a></li></ul><div class="clear"> </div><h3 id="time"> </h3><table id="table"><thead></thead><tbody></tbody></table><div class="clear"> </div><h2 id="stats"></h2><p class="info">Click on a date to view events. Use arrow keys to browser the calendar.<span class="info" id="credit">localStorage based personal planner by <a href="http://kailashnadh.name">Kailash Nadh</a> for <a href="http://10k.aneventapart.com">10k Apart</a></span></p><div class="clear"> </div></div><div class="clear"> </div></div><div id="diary-wrap" class="box"><div class="content"><a href="#" id="diary-close" class="round">&lt;</a><h2 id="diary-title">&nbsp;</h2><div class="clear"> </div><ul id="diary"></ul><p class="info">Click on a time to add an event</p></div></div><div id="dialog"><a href="#" id="dialog-close" class="round">x</a><form id="add" class="target"><h2 id="event-date"></h2><p class="time"><label>Event time</label>Hour <select id="event-hour"></select>Minute <select id="event-minute"></select></p><p><label>Event description</label><input type="text" id="event-description" maxlength="100" /></p><div id="event-label"></div><p class="buttons"><input type="submit" id="event-create" value="ok" class="button" /><input type="button" id="event-close" value="cancel" class="button" /><input type="button" id="event-delete" value="delete" class="button" /><input type="button" id="event-tweet" value="tweet" class="button" /></p></form><div id="ical" class="target">Copy the text and save it as  calendar.ics file.<br /><small>You can then import the file to Google Calendar, iCal etc.</small><textarea id="ical-data"> </textarea></div></div><div class="clear"> </div><!--- begin: paste somewhere in body ---><p id="syncStorage"></p><!--- end --->'
  }
